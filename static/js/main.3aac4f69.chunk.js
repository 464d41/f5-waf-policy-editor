(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{153:function(e,t,n){"use strict";n.r(t);var i=n(10),r=n(11),c=n(48),a=n(13),s=n(12),o=n(1),l=n.n(o),h=n(55),p=n.n(h),d=(n(83),n(78)),j=n(15),u=n(58),g=n(34),O=n(59),b=n(0),y=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(b.jsxs)(O.a,{variant:"pills",className:"flex-column",activeKey:this.props.activeKey,children:[Object(b.jsx)(x,{name:"General",onClick:this.props.onClick}),Object(b.jsx)(x,{name:"Blocking Settings",onClick:this.props.onClick}),Object(b.jsx)(x,{name:"Methods",onClick:this.props.onClick}),Object(b.jsx)(x,{name:"URLs",onClick:this.props.onClick}),Object(b.jsx)(x,{name:"Filetypes",onClick:this.props.onClick}),Object(b.jsx)(x,{name:"Headers",onClick:this.props.onClick}),Object(b.jsx)(x,{name:"Parameters",onClick:this.props.onClick}),Object(b.jsx)(x,{name:"Signatures",onClick:this.props.onClick,disabled:!0}),Object(b.jsx)(x,{name:"Bot Defense",onClick:this.props.onClick,disabled:!0})]})}}]),n}(l.a.Component),x=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){var e=this;return Object(b.jsx)(O.a.Item,{onClick:function(){return e.props.onClick(e.props.name)},children:Object(b.jsx)(O.a.Link,{eventKey:this.props.name,disabled:this.props.disabled?"disabled":"",children:this.props.name})})}}]),n}(l.a.Component),v=n(23),m=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={policy:r.props.policy},r}return Object(r.a)(n,[{key:"changeName",value:function(e){var t=this.props.policy;t.name=e.target.value,this.props.onChange(t)}},{key:"changeApplicationLanguage",value:function(e){var t=this.props.policy;t.applicationLanguage=e.target.value,this.props.onChange(t)}},{key:"changeEnforcementMode",value:function(e){var t=this.props.policy;t.enforcementMode=e.target.value,this.props.onChange(t)}},{key:"changeTemplateName",value:function(e){var t=this.props.policy;t.template.name=e.target.value,this.props.onChange(t)}},{key:"render",value:function(){var e,t,n=this;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"General Settings"}),Object(b.jsxs)(v.a,{size:"sm",children:[Object(b.jsx)(v.a.Prepend,{children:Object(b.jsx)(v.a.Text,{children:"Policy Name"})}),Object(b.jsx)(j.a,{type:"text",value:this.props.policy.name,onChange:function(e){return n.changeName(e)}})]}),Object(b.jsxs)(v.a,{size:"sm",children:[Object(b.jsx)(v.a.Prepend,{children:Object(b.jsx)(v.a.Text,{children:"Application Language"})}),Object(b.jsx)(j.a,{value:this.props.policy.applicationLanguage,onChange:function(e){return n.changeApplicationLanguage(e)}})]}),Object(b.jsxs)(v.a,{size:"sm",children:[Object(b.jsx)(v.a.Prepend,{children:Object(b.jsx)(v.a.Text,{children:"Enforcement Mode"})}),Object(b.jsx)(j.a,{value:this.props.policy.enforcementMode,onChange:function(e){return n.changeEnforcementMode(e)}})]}),Object(b.jsxs)(v.a,{size:"sm",children:[Object(b.jsx)(v.a.Prepend,{children:Object(b.jsx)(v.a.Text,{children:"Template"})}),Object(b.jsx)(j.a,{value:null===(e=this.props.policy)||void 0===e||null===(t=e.template)||void 0===t?void 0:t.name,onChange:function(e){return n.changeTemplateName(e)}})]})]})}}]),n}(l.a.Component),f=n(16),C=n(25),k=n(14),S=n(6),L=n(21),P=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Blocking Settings"}),Object(b.jsx)(M,{policy:this.props.policy,onChange:this.props.onChange}),Object(b.jsx)(z,{policy:this.props.policy,onChange:this.props.onChange})]})}}]),n}(l.a.Component),M=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"addViolation",value:function(e){var t=this.props.policy,n=t.getAllViolations().find((function(t){return t.name===e.target.id}));t.blockingSettings.violations.push(n),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return Object(b.jsxs)(S.a,{as:L.a,className:"mb-2",size:"sm",children:[Object(b.jsx)(S.a.Toggle,{id:"dropdown-basic",children:"Add Violation"}),Object(b.jsx)(S.a.Menu,{children:this.props.policy.getAllViolations().map((function(t){return Object(b.jsx)(S.a.Item,{id:t.name,onClick:function(t){return e.addViolation(t)},children:t.title},t.name)}))})]})}}]),n}(l.a.Component),z=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"toggleAlarm",value:function(e){var t=this.props.policy;t.blockingSettings.violations[e.target.id].alarm=!t.blockingSettings.violations[e.target.id].alarm,this.props.onChange(t)}},{key:"toggleBlock",value:function(e){var t=this.props.policy;t.blockingSettings.violations[e.target.id].block=!t.blockingSettings.violations[e.target.id].block,this.props.onChange(t)}},{key:"toggleLearn",value:function(e){var t=this.props.policy;t.blockingSettings.violations[e.target.id].learn=!t.blockingSettings.violations[e.target.id].learn,this.props.onChange(t)}},{key:"delViolation",value:function(e){var t=this.props.policy;t.blockingSettings.violations.splice(e.target.id,1),this.props.onChange(t)}},{key:"delAllViolations",value:function(e){var t=this.props.policy;t.blockingSettings.violations=[],this.props.onChange(t)}},{key:"render",value:function(){var e,t=this;return Object(b.jsx)("div",{children:Object(b.jsxs)(C.a,{striped:!0,bordered:!0,hover:!0,size:"sm",className:"text-center",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{className:"text-left",children:"Violation"}),Object(b.jsx)("th",{children:"Alarm"}),Object(b.jsx)("th",{children:"Block"}),Object(b.jsx)("th",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return t.delAllViolations(e)},children:"Remove"})})]})}),Object(b.jsx)("tbody",{children:null===(e=this.props.policy.blockingSettings.violations)||void 0===e?void 0:e.map((function(e,n){return Object(b.jsxs)("tr",{children:[Object(b.jsx)("td",{className:"text-left",children:e.title}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.toString(),checked:e.alarm||!1,onChange:function(e){return t.toggleAlarm(e)}})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{type:"checkbox",id:n.toString(),checked:e.block||!1,onChange:function(e){return t.toggleBlock(e)}})}),Object(b.jsx)("td",{children:Object(b.jsx)(f.a,{size:"sm",id:n.toString(),onClick:function(e){return t.delViolation(e)},children:"Remove"})})]},e.name)}))})]})})}}]),n}(l.a.Component),A=n(19),N=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"addMethod",value:function(e){var t=this.props.policy,n=new A.Method;t.methods.push(n),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Methods"}),Object(b.jsx)(f.a,{size:"sm",className:"mb-2",onClick:function(t){return e.addMethod(t)},children:"Add Method"}),Object(b.jsx)(w,{policy:this.props.policy,onChange:this.props.onChange})]})}}]),n}(l.a.Component),w=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"changeName",value:function(e){var t=this.props.policy;t.methods[e.target.id].name=e.target.value,this.props.onChange(t)}},{key:"delMethod",value:function(e){var t=this.props.policy;t.methods.splice(e.target.id,1),this.props.onChange(t)}},{key:"delAllMethods",value:function(e){var t=this.props.policy;t.methods=[],this.props.onChange(t)}},{key:"render",value:function(){var e,t,n=this;return Object(b.jsx)("div",{children:Object(b.jsxs)(C.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Method Name"}),Object(b.jsx)("th",{className:"text-center",children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delAllMethods(e)},children:"Remove"})})]})}),Object(b.jsx)("tbody",{children:null===(e=this.props.policy)||void 0===e||null===(t=e.methods)||void 0===t?void 0:t.map((function(e,t){return Object(b.jsxs)("tr",{className:"text-center",children:[Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.methods.indexOf(e).toString(),onChange:function(e){return n.changeName(e)},size:"sm",value:e.name})}),Object(b.jsx)("td",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delMethod(e)},children:"Remove"})})]},t)}))})]})})}}]),n}(l.a.Component),R=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"addUrl",value:function(e){var t=this.props.policy,n=new A.Url;t.urls.push(n),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"URLs"}),Object(b.jsx)(f.a,{size:"sm",className:"mb-2",onClick:function(t){return e.addUrl(t)},children:"Add URL"}),Object(b.jsx)(T,{policy:this.props.policy,onChange:this.props.onChange})]})}}]),n}(l.a.Component),T=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"changeName",value:function(e){var t=this.props.policy;t.urls[e.target.id].name=e.target.value,this.props.onChange(t)}},{key:"changeMethod",value:function(e){var t=this.props.policy;t.urls[e.target.id].method=e.target.value,this.props.onChange(t)}},{key:"changeProtocol",value:function(e){var t=this.props.policy;t.urls[e.target.id].protocol=e.target.text,this.props.onChange(t)}},{key:"changeType",value:function(e){var t=this.props.policy;t.urls[e.target.id].type=e.target.text,this.props.onChange(t)}},{key:"toggleAttackSignaturesCheck",value:function(e){var t=this.props.policy;t.urls[e.target.id].attackSignaturesCheck=!t.urls[e.target.id].attackSignaturesCheck,this.props.onChange(t)}},{key:"toggleMetacharsOnUrlCheck",value:function(e){var t=this.props.policy;t.urls[e.target.id].metacharsOnUrlCheck=!t.urls[e.target.id].metacharsOnUrlCheck,this.props.onChange(t)}},{key:"changeWildcardOrder",value:function(e){var t=this.props.policy;t.urls[e.target.id].wildcardOrder=parseInt(e.target.value)||0,this.props.onChange(t)}},{key:"toggleBase64",value:function(e){var t=this.props.policy;t.urls[e.target.id].wildcardOrder=!t.urls[e.target.id].wildcardOrder,this.props.onChange(t)}},{key:"toggleAllowRepeatedOccurrences",value:function(e){var t=this.props.policy;t.urls[e.target.id].allowRepeatedOccurrences=!t.urls[e.target.id].allowRepeatedOccurrences,this.props.onChange(t)}},{key:"delUrl",value:function(e){var t=this.props.policy;t.urls.splice(e.target.id,1),this.props.onChange(t)}},{key:"delAllUrls",value:function(e){var t=this.props.policy;t.urls=[],this.props.onChange(t)}},{key:"render",value:function(){var e,t,n=this;return Object(b.jsx)("div",{children:Object(b.jsxs)(C.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Name"}),Object(b.jsx)("th",{children:"Method"}),Object(b.jsx)("th",{children:"Protocol"}),Object(b.jsx)("th",{children:"Type"}),Object(b.jsx)("th",{children:"Check Signatures"}),Object(b.jsx)("th",{children:"Check Metachars"}),Object(b.jsx)("th",{children:"Order"}),Object(b.jsx)("th",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delAllUrls(e)},children:"Remove"})})]})}),Object(b.jsx)("tbody",{children:null===(e=this.props.policy)||void 0===e||null===(t=e.urls)||void 0===t?void 0:t.map((function(e,t){return Object(b.jsxs)("tr",{className:"text-center",children:[Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.urls.indexOf(e).toString(),onChange:function(e){return n.changeName(e)},size:"sm",value:e.name})}),Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.urls.indexOf(e).toString(),onChange:function(e){return n.changeMethod(e)},size:"sm",value:e.method})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.protocol}),Object(b.jsxs)(S.a.Menu,{children:[Object(b.jsx)(S.a.Item,{id:n.props.policy.urls.indexOf(e).toString(),onClick:function(e){return n.changeProtocol(e)},children:"http"}),Object(b.jsx)(S.a.Item,{id:n.props.policy.urls.indexOf(e).toString(),onClick:function(e){return n.changeProtocol(e)},children:"https"})]})]})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.type}),Object(b.jsxs)(S.a.Menu,{children:[Object(b.jsx)(S.a.Item,{id:n.props.policy.urls.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"explicit"}),Object(b.jsx)(S.a.Item,{id:n.props.policy.urls.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"wildcard"})]})]})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.urls.indexOf(e).toString(),onChange:function(e){return n.toggleAttackSignaturesCheck(e)},checked:e.attackSignaturesCheck})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.urls.indexOf(e).toString(),onChange:function(e){return n.toggleMetacharsOnUrlCheck(e)},checked:e.metacharsOnUrlCheck})}),Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.urls.indexOf(e).toString(),onChange:function(e){return n.changeWildcardOrder(e)},size:"sm",value:e.wildcardOrder})}),Object(b.jsx)("td",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delUrl(e)},children:"Remove"})})]},t)}))})]})})}}]),n}(l.a.Component),V=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"addFiletype",value:function(e){var t=this.props.policy,n=new A.Filetype;t.filetypes.push(n),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Filetypes"}),Object(b.jsx)(f.a,{size:"sm",className:"mb-2",onClick:function(t){return e.addFiletype(t)},children:"Add Filetype"}),Object(b.jsx)(U,{policy:this.props.policy,onChange:this.props.onChange})]})}}]),n}(l.a.Component),U=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"changeName",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].name=e.target.value,this.props.onChange(t)}},{key:"changeType",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].type=e.target.text,this.props.onChange(t)}},{key:"toggleAllowed",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].allowed=!t.filetypes[e.target.id].allowed,this.props.onChange(t)}},{key:"toggleCheckUrlLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].checkUrlLength=!t.filetypes[e.target.id].checkUrlLength,this.props.onChange(t)}},{key:"changeUrlLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].urlLength=parseInt(e.target.value)||0,this.props.onChange(t)}},{key:"toggleCheckQueryStringLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].checkQueryStringLength=!t.filetypes[e.target.id].checkQueryStringLength,this.props.onChange(t)}},{key:"changeQueryStringLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].queryStringLength=parseInt(e.target.value)||0,this.props.onChange(t)}},{key:"toggleCheckPostDataLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].checkPostDataLength=!t.filetypes[e.target.id].checkPostDataLength,this.props.onChange(t)}},{key:"changePostDataLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].postDataLength=parseInt(e.target.value)||0,this.props.onChange(t)}},{key:"toggleCheckRequestLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].checkRequestLength=!t.filetypes[e.target.id].checkRequestLength,this.props.onChange(t)}},{key:"changeRequestLength",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].requestLength=parseInt(e.target.value)||0,this.props.onChange(t)}},{key:"toggleResponseCheck",value:function(e){var t=this.props.policy;t.filetypes[e.target.id].responseCheck=!t.filetypes[e.target.id].responseCheck,this.props.onChange(t)}},{key:"delFiletype",value:function(e){var t=this.props.policy;t.filetypes.splice(e.target.id,1),this.props.onChange(t)}},{key:"delAllFiletypes",value:function(e){var t=this.props.policy;t.filetypes=[],this.props.onChange(t)}},{key:"render",value:function(){var e,t,n=this;return Object(b.jsx)("div",{children:Object(b.jsxs)(C.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Filetype Name"}),Object(b.jsx)("th",{children:"Type"}),Object(b.jsx)("th",{children:"Allowed"}),Object(b.jsx)("th",{children:"Check URL Length"}),Object(b.jsx)("th",{children:"URL Length"}),Object(b.jsx)("th",{children:"Check QS Length"}),Object(b.jsx)("th",{children:"QS Length"}),Object(b.jsx)("th",{children:"Check POST Data Length"}),Object(b.jsx)("th",{children:"POST Data Length"}),Object(b.jsx)("th",{children:"Check Request Length"}),Object(b.jsx)("th",{children:"Request Length"}),Object(b.jsx)("th",{children:"Check Response"}),Object(b.jsx)("th",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delAllFiletypes(e)},children:"Remove"})})]})}),Object(b.jsx)("tbody",{children:null===(e=this.props.policy)||void 0===e||null===(t=e.filetypes)||void 0===t?void 0:t.map((function(e,t){return Object(b.jsxs)("tr",{className:"text-center",children:[Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.changeName(e)},size:"sm",value:e.name})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.type}),Object(b.jsxs)(S.a.Menu,{children:[Object(b.jsx)(S.a.Item,{id:n.props.policy.filetypes.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"explicit"}),Object(b.jsx)(S.a.Item,{id:n.props.policy.filetypes.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"wildcard"})]})]})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.toggleAllowed(e)},checked:e.allowed})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.toggleCheckUrlLength(e)},checked:e.checkUrlLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.changeUrlLength(e)},size:"sm",value:e.urlLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.toggleCheckQueryStringLength(e)},checked:e.checkQueryStringLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.changeQueryStringLength(e)},size:"sm",value:e.queryStringLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.toggleCheckPostDataLength(e)},checked:e.checkPostDataLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.changePostDataLength(e)},size:"sm",value:e.postDataLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.toggleCheckRequestLength(e)},checked:e.checkRequestLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.changeRequestLength(e)},size:"sm",value:e.requestLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.filetypes.indexOf(e).toString(),onChange:function(e){return n.toggleResponseCheck(e)},checked:e.responseCheck})}),Object(b.jsx)("td",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delFiletype(e)},children:"Remove"})})]},t)}))})]})})}}]),n}(l.a.Component),I=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"addHeader",value:function(e){var t=this.props.policy,n=new A.Header;t.headers.push(n),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Headers"}),Object(b.jsx)(f.a,{size:"sm",className:"mb-2",onClick:function(t){return e.addHeader(t)},children:"Add Header"}),Object(b.jsx)(B,{policy:this.props.policy,onChange:this.props.onChange})]})}}]),n}(l.a.Component),B=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"changeName",value:function(e){var t=this.props.policy;t.headers[e.target.id].name=e.target.value,this.props.onChange(t)}},{key:"changeType",value:function(e){var t=this.props.policy;t.headers[e.target.id].type=e.target.text,this.props.onChange(t)}},{key:"toggleMandatory",value:function(e){var t=this.props.policy;t.headers[e.target.id].mandatory=!t.headers[e.target.id].mandatory,this.props.onChange(t)}},{key:"toggleCheckSignatures",value:function(e){var t=this.props.policy;t.headers[e.target.id].checkSignatures=!t.headers[e.target.id].checkSignatures,this.props.onChange(t)}},{key:"toggleHtmlNormalization",value:function(e){var t=this.props.policy;t.headers[e.target.id].htmlNormalization=!t.headers[e.target.id].htmlNormalization,this.props.onChange(t)}},{key:"toggleBase64",value:function(e){var t=this.props.policy;t.headers[e.target.id].decodeValueAsBase64=!t.headers[e.target.id].decodeValueAsBase64,this.props.onChange(t)}},{key:"toggleAllowRepeatedOccurrences",value:function(e){var t=this.props.policy;t.headers[e.target.id].allowRepeatedOccurrences=!t.headers[e.target.id].allowRepeatedOccurrences,this.props.onChange(t)}},{key:"delHeader",value:function(e){var t=this.props.policy;t.headers.splice(e.target.id,1),this.props.onChange(t)}},{key:"delAllHeaders",value:function(e){var t=this.props.policy;t.headers=[],this.props.onChange(t)}},{key:"render",value:function(){var e,t,n=this;return Object(b.jsx)("div",{children:Object(b.jsxs)(C.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Header Name"}),Object(b.jsx)("th",{children:"Type"}),Object(b.jsx)("th",{children:"Mandatory"}),Object(b.jsx)("th",{children:"Check Signatures"}),Object(b.jsx)("th",{children:"Normalize HTML"}),Object(b.jsx)("th",{children:"Decode Base64"}),Object(b.jsx)("th",{children:"Allow Repeated"}),Object(b.jsx)("th",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delAllHeaders(e)},children:"Remove"})})]})}),Object(b.jsx)("tbody",{children:null===(e=this.props.policy)||void 0===e||null===(t=e.headers)||void 0===t?void 0:t.map((function(e,t){return Object(b.jsxs)("tr",{className:"text-center",children:[Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.headers.indexOf(e).toString(),onChange:function(e){return n.changeName(e)},size:"sm",value:e.name})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.type}),Object(b.jsxs)(S.a.Menu,{children:[Object(b.jsx)(S.a.Item,{id:n.props.policy.headers.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"explicit"}),Object(b.jsx)(S.a.Item,{id:n.props.policy.headers.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"wildcard"})]})]})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.headers.indexOf(e).toString(),onChange:function(e){return n.toggleMandatory(e)},checked:e.mandatory})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.headers.indexOf(e).toString(),onChange:function(e){return n.toggleCheckSignatures(e)},checked:e.checkSignatures})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.headers.indexOf(e).toString(),onChange:function(e){return n.toggleHtmlNormalization(e)},checked:e.htmlNormalization})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.headers.indexOf(e).toString(),onChange:function(e){return n.toggleBase64(e)},checked:e.decodeValueAsBase64})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.headers.indexOf(e).toString(),onChange:function(e){return n.toggleAllowRepeatedOccurrences(e)},checked:e.allowRepeatedOccurrences})}),Object(b.jsx)("td",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delHeader(e)},children:"Remove"})})]},t)}))})]})})}}]),n}(l.a.Component),D=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"addParameter",value:function(e){var t=this.props.policy,n=new A.Parameter;t.parameters.push(n),this.props.onChange(t)}},{key:"render",value:function(){var e=this;return Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Parameters"}),Object(b.jsx)(f.a,{size:"sm",className:"mb-2",onClick:function(t){return e.addParameter(t)},children:"Add Parameter"}),Object(b.jsx)(H,{policy:this.props.policy,onChange:this.props.onChange})]})}}]),n}(l.a.Component),H=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"changeName",value:function(e){var t=this.props.policy;t.parameters[e.target.id].name=e.target.value,this.props.onChange(t)}},{key:"changeType",value:function(e){var t=this.props.policy;t.parameters[e.target.id].type=e.target.text,this.props.onChange(t)}},{key:"changeLevel",value:function(e){var t=this.props.policy;t.parameters[e.target.id].level=e.target.text,this.props.onChange(t)}},{key:"changeParameterLocation",value:function(e){var t=this.props.policy;t.parameters[e.target.id].parameterLocation=e.target.text,this.props.onChange(t)}},{key:"changeValueType",value:function(e){var t=this.props.policy;t.parameters[e.target.id].valueType=e.target.text,this.props.onChange(t)}},{key:"toggleAllowEmptyValue",value:function(e){var t=this.props.policy;t.parameters[e.target.id].allowEmptyValue=!t.parameters[e.target.id].allowEmptyValue,this.props.onChange(t)}},{key:"toggleCheckMaxValueLength",value:function(e){var t=this.props.policy;t.parameters[e.target.id].checkMaxValueLength=!t.parameters[e.target.id].checkMaxValueLength,this.props.onChange(t)}},{key:"toggleAllowRepeatedParameterName",value:function(e){var t=this.props.policy;t.parameters[e.target.id].allowRepeatedParameterName=!t.parameters[e.target.id].allowRepeatedParameterName,this.props.onChange(t)}},{key:"toggleSensitiveParameter",value:function(e){var t=this.props.policy;t.parameters[e.target.id].sensitiveParameter=!t.parameters[e.target.id].sensitiveParameter,this.props.onChange(t)}},{key:"toggleAttackSignaturesCheck",value:function(e){var t=this.props.policy;t.parameters[e.target.id].attackSignaturesCheck=!t.parameters[e.target.id].attackSignaturesCheck,this.props.onChange(t)}},{key:"toggleCheckMetachars",value:function(e){var t=this.props.policy;t.parameters[e.target.id].checkMetachars=!t.parameters[e.target.id].checkMetachars,this.props.onChange(t)}},{key:"toggleMetacharsOnParameterValueCheck",value:function(e){var t=this.props.policy;t.parameters[e.target.id].metacharsOnParameterValueCheck=!t.parameters[e.target.id].metacharsOnParameterValueCheck,this.props.onChange(t)}},{key:"delParameter",value:function(e){var t=this.props.policy;t.parameters.splice(e.target.id,1),this.props.onChange(t)}},{key:"delAllParameters",value:function(e){var t=this.props.policy;t.parameters=[],this.props.onChange(t)}},{key:"render",value:function(){var e,t,n=this;return Object(b.jsx)("div",{children:Object(b.jsxs)(C.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(b.jsx)("thead",{children:Object(b.jsxs)("tr",{children:[Object(b.jsx)("th",{children:"Name"}),Object(b.jsx)("th",{children:"Type"}),Object(b.jsx)("th",{children:"Level"}),Object(b.jsx)("th",{children:"Location"}),Object(b.jsx)("th",{children:"Value type"}),Object(b.jsx)("th",{children:"Allow Empty Value"}),Object(b.jsx)("th",{children:"Check Max Value Length"}),Object(b.jsx)("th",{children:"Allow Repeated"}),Object(b.jsx)("th",{children:"Sensitive"}),Object(b.jsx)("th",{children:"Check Attack Signatures"}),Object(b.jsx)("th",{children:"Check Metachars"}),Object(b.jsx)("th",{children:"Check Metachars on Value"}),Object(b.jsx)("th",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delAllParameters(e)},children:"Remove"})})]})}),Object(b.jsx)("tbody",{children:null===(e=this.props.policy)||void 0===e||null===(t=e.parameters)||void 0===t?void 0:t.map((function(e,t){return Object(b.jsxs)("tr",{className:"text-center",children:[Object(b.jsx)("td",{children:Object(b.jsx)(j.a,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.changeName(e)},size:"sm",value:e.name})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.type}),Object(b.jsxs)(S.a.Menu,{children:[Object(b.jsx)(S.a.Item,{id:n.props.policy.parameters.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"explicit"}),Object(b.jsx)(S.a.Item,{id:n.props.policy.parameters.indexOf(e).toString(),onClick:function(e){return n.changeType(e)},children:"wildcard"})]})]})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.level}),Object(b.jsx)(S.a.Menu,{children:Object(b.jsx)(S.a.Item,{id:n.props.policy.parameters.indexOf(e).toString(),onClick:function(e){return n.changeLevel(e)},children:"global"})})]})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.parameterLocation}),Object(b.jsx)(S.a.Menu,{children:Object(b.jsx)(S.a.Item,{id:n.props.policy.parameters.indexOf(e).toString(),onClick:function(e){return n.changeParameterLocation(e)},children:"any"})})]})}),Object(b.jsx)("td",{children:Object(b.jsxs)(S.a,{as:L.a,size:"sm",children:[Object(b.jsx)(S.a.Toggle,{children:e.valueType}),Object(b.jsx)(S.a.Menu,{children:Object(b.jsx)(S.a.Item,{id:n.props.policy.parameters.indexOf(e).toString(),onClick:function(e){return n.changeValueType(e)},children:"auto-detect"})})]})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.toggleAllowEmptyValue(e)},checked:e.allowEmptyValue})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.toggleCheckMaxValueLength(e)},checked:e.checkMaxValueLength})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.toggleAllowRepeatedParameterName(e)},checked:e.allowRepeatedParameterName})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.toggleSensitiveParameter(e)},checked:e.sensitiveParameter})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.toggleAttackSignaturesCheck(e)},checked:e.attackSignaturesCheck})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.toggleCheckMetachars(e)},checked:e.checkMetachars})}),Object(b.jsx)("td",{children:Object(b.jsx)(k.a.Check,{id:n.props.policy.parameters.indexOf(e).toString(),onChange:function(e){return n.toggleMetacharsOnParameterValueCheck(e)},checked:e.metacharsOnParameterValueCheck})}),Object(b.jsx)("td",{children:Object(b.jsx)(f.a,{size:"sm",onClick:function(e){return n.delParameter(e)},children:"Remove"})})]},t)}))})]})})}}]),n}(l.a.Component),F=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(r.a)(n,[{key:"render",value:function(){return Object(b.jsxs)("div",{children:["General"===this.props.visibleComponent&&Object(b.jsx)(m,{policy:this.props.policy,onChange:this.props.onChange}),"Blocking Settings"===this.props.visibleComponent&&Object(b.jsx)(P,{policy:this.props.policy,onChange:this.props.onChange}),"Methods"===this.props.visibleComponent&&Object(b.jsx)(N,{policy:this.props.policy,onChange:this.props.onChange}),"URLs"===this.props.visibleComponent&&Object(b.jsx)(R,{policy:this.props.policy,onChange:this.props.onChange}),"Filetypes"===this.props.visibleComponent&&Object(b.jsx)(V,{policy:this.props.policy,onChange:this.props.onChange}),"Headers"===this.props.visibleComponent&&Object(b.jsx)(I,{policy:this.props.policy,onChange:this.props.onChange}),"Parameters"===this.props.visibleComponent&&Object(b.jsx)(D,{policy:this.props.policy,onChange:this.props.onChange}),"Signatures"===this.props.visibleComponent&&Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Signatures"}),Object(b.jsx)("h3",{children:"TBD"})]}),"Bot Defense"===this.props.visibleComponent&&Object(b.jsxs)("div",{children:[Object(b.jsx)("h2",{children:"Bot Defense"}),Object(b.jsx)("h3",{children:"TBD"})]})]})}}]),n}(l.a.Component);var q=function(e){Object(a.a)(n,e);var t=Object(s.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this,e)).state={policy:new A.Policy,textArea:JSON.stringify((new A.Policy).toPolicy(),void 0,4),visibleComponent:"General",isValid:(new A.Policy).isValid()},r.handleChange=r.handleChange.bind(Object(c.a)(r)),r.handleMenuClick=r.handleMenuClick.bind(Object(c.a)(r)),r}return Object(r.a)(n,[{key:"handleChange",value:function(e){this.setState((function(t){return{isValid:Object(A.isValidPolicy)(e.toPolicy()),policy:e,textArea:JSON.stringify(e.toPolicy(),void 0,4)}}))}},{key:"handleTextChange",value:function(e){if(this.setState({textArea:e.target.value}),function(e){if("string"!==typeof e)return!1;try{return JSON.parse(e),!0}catch(t){return!1}}(e.target.value)&&Object(A.isValidPolicy)(JSON.parse(e.target.value))){var t=new A.Policy(JSON.parse(e.target.value));this.setState({isValid:!0,policy:t,textArea:JSON.stringify(t.toPolicy(),void 0,4)})}else this.setState({isValid:!1})}},{key:"handleMenuClick",value:function(e){this.setState((function(){return{visibleComponent:e}}))}},{key:"render",value:function(){var e=this;return Object(b.jsxs)(d.a,{style:{"max-width":"1400px"},children:[Object(b.jsx)(u.a,{children:Object(b.jsx)(g.a,{children:Object(b.jsx)("h1",{children:"F5 WAF Policy Editor"})})}),Object(b.jsxs)(u.a,{children:[Object(b.jsx)(g.a,{md:"auto",children:Object(b.jsx)(y,{onClick:this.handleMenuClick,activeKey:this.state.visibleComponent})}),Object(b.jsx)(g.a,{children:Object(b.jsx)(F,{policy:this.state.policy,onChange:this.handleChange,visibleComponent:this.state.visibleComponent})})]}),Object(b.jsx)(u.a,{children:Object(b.jsx)(g.a,{children:Object(b.jsx)(j.a,{as:"textarea",value:this.state.textArea,rows:20,cols:60,onChange:function(t){return e.handleTextChange(t)},style:{color:this.state.isValid?"green":"red"}})})})]})}}]),n}(l.a.Component);p.a.render(Object(b.jsx)(q,{}),document.getElementById("root"))}},[[153,1,2]]]);
//# sourceMappingURL=main.3aac4f69.chunk.js.map