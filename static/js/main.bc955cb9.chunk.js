(this["webpackJsonpmy-app"]=this["webpackJsonpmy-app"]||[]).push([[0],{149:function(e,t,n){"use strict";n.r(t);var i=n(12),a=n(13),c=n(11),o=n(15),r=n(14),s=n(0),l=n.n(s),d=n(52),h=n.n(d),p=(n(83),n(78)),j=n(20),g=n(56),u=n(33),b=n(57),O=n(1),y=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return Object(O.jsxs)(b.a,{variant:"pills",className:"flex-column",activeKey:this.props.activeKey,children:[Object(O.jsx)(x,{name:"General",onClick:this.props.onClick}),Object(O.jsx)(x,{name:"Blocking Settings",onClick:this.props.onClick}),Object(O.jsx)(x,{name:"Signatures",onClick:this.props.onClick}),Object(O.jsx)(x,{name:"Headers",onClick:this.props.onClick}),Object(O.jsx)(x,{name:"Bot Defense",onClick:this.props.onClick})]})}}]),n}(l.a.Component),x=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this;return Object(O.jsx)(b.a.Item,{onClick:function(){return e.props.onClick(e.props.name)},children:Object(O.jsx)(b.a.Link,{eventKey:this.props.name,children:this.props.name})})}}]),n}(l.a.Component);function v(e,t,n){t=function(e){if("string"!==typeof e)return e;var t=[];return e.split(".").forEach((function(e,n){e.split(/\[([^}]+)\]/g).forEach((function(e){e.length>0&&t.push(e)}))})),t}(t);for(var i=0;i<t.length-1;i++)e=e[t[i]];e[t[t.length-1]]=n}var m=n(18),f=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={policy:a.props.policy},a}return Object(a.a)(n,[{key:"handleChange",value:function(e){var t=Object.assign(Object.create(Object.getPrototypeOf(this.props.policy)),this.props.policy);v(t.policy,e.target.id,e.target.value),this.props.onChange(t)}},{key:"render",value:function(){var e,t,n=this;return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"General Settings"}),Object(O.jsxs)(m.a,{size:"sm",children:[Object(O.jsx)(m.a.Prepend,{children:Object(O.jsx)(m.a.Text,{children:"Policy Name"})}),Object(O.jsx)(j.a,{type:"text",id:"name",value:this.props.policy.policy.name||"",onChange:function(e){return n.handleChange(e)}})]}),Object(O.jsxs)(m.a,{size:"sm",children:[Object(O.jsx)(m.a.Prepend,{children:Object(O.jsx)(m.a.Text,{children:"Application Language"})}),Object(O.jsx)(j.a,{id:"applicationLanguage",value:this.props.policy.policy.applicationLanguage||"",onChange:function(e){return n.handleChange(e)}})]}),Object(O.jsxs)(m.a,{size:"sm",children:[Object(O.jsx)(m.a.Prepend,{children:Object(O.jsx)(m.a.Text,{children:"Enforcement Mode"})}),Object(O.jsx)(j.a,{id:"enforcementMode",value:this.props.policy.policy.enforcementMode||"",onChange:function(e){return n.handleChange(e)}})]}),Object(O.jsxs)(m.a,{size:"sm",children:[Object(O.jsx)(m.a.Prepend,{children:Object(O.jsx)(m.a.Text,{children:"Template"})}),Object(O.jsx)(j.a,{id:"template.name",value:(null===(e=this.props.policy.policy)||void 0===e||null===(t=e.template)||void 0===t?void 0:t.name)||"",onChange:function(e){return n.handleChange(e)}})]})]})}}]),n}(l.a.Component),C=n(30),k=n(55),N=n(22),S=n(21),A=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).handleChange=a.handleChange.bind(Object(c.a)(a)),a.addViolation=a.addViolation.bind(Object(c.a)(a)),a.removeViolation=a.removeViolation.bind(Object(c.a)(a)),a}return Object(a.a)(n,[{key:"handleChange",value:function(e){var t=Object.assign(Object.create(Object.getPrototypeOf(this.props.policy)),this.props.policy);v(t.policy,e.target.id,e.target.checked),this.props.onChange(t)}},{key:"addViolation",value:function(e){var t,n,i=Object.assign(Object.create(Object.getPrototypeOf(this.props.policy)),this.props.policy),a=(null===(t=i.policy)||void 0===t||null===(n=t["blocking-settings"])||void 0===n?void 0:n.violations)||[];a.find((function(t){return t.name===e.target.id}))||a.push({name:e.target.id,alarm:this.props.policy.getAllViolations().find((function(t){return t.name===e.target.id})).alarm||!1,block:this.props.policy.getAllViolations().find((function(t){return t.name===e.target.id})).block||!1,learn:this.props.policy.getAllViolations().find((function(t){return t.name===e.target.id})).learn||!1}),i.policy["blocking-settings"]={violations:a},this.props.onChange(i)}},{key:"removeViolation",value:function(e){var t=Object.assign(Object.create(Object.getPrototypeOf(this.props.policy)),this.props.policy);t.policy["blocking-settings"].violations.splice(e.target.id,1),0===t.policy["blocking-settings"].violations.length&&delete t.policy["blocking-settings"].violations,0===Object.keys(t.policy["blocking-settings"]).length&&delete t.policy["blocking-settings"],this.props.onChange(t)}},{key:"render",value:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Blocking Settings"}),Object(O.jsxs)(N.a,{children:[Object(O.jsx)(H,{violations:this.props.policy.getAllViolations(),onClick:this.addViolation}),Object(O.jsx)(V,{policy:this.props.policy,onChange:this.handleChange,onRemove:this.removeViolation})]})]})}}]),n}(l.a.Component),H=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e=this;return Object(O.jsxs)(S.a,{className:"mb-2",children:[Object(O.jsx)(S.a.Toggle,{id:"dropdown-basic",children:"Violations"}),Object(O.jsx)(S.a.Menu,{children:this.props.violations.map((function(t){return Object(O.jsx)(S.a.Item,{id:t.name,onClick:e.props.onClick,children:t.title},t.name)}))})]})}}]),n}(l.a.Component),V=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e,t,n,i=this;return Object(O.jsx)("div",{children:Object(O.jsxs)(k.a,{striped:!0,bordered:!0,hover:!0,size:"sm",className:"text-center",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{className:"text-left",children:"Violation"}),Object(O.jsx)("th",{children:"Alarm"}),Object(O.jsx)("th",{children:"Block"}),Object(O.jsx)("th",{children:"Learn"}),Object(O.jsx)("th",{})]})}),Object(O.jsx)("tbody",{children:null===(e=this.props.policy.policy)||void 0===e||null===(t=e["blocking-settings"])||void 0===t||null===(n=t.violations)||void 0===n?void 0:n.map((function(e){var t;return Object(O.jsxs)("tr",{children:[Object(O.jsx)("td",{className:"text-left",children:null===(t=i.props.policy.getAllViolations().find((function(t){return t.name===e.name})))||void 0===t?void 0:t.title}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{id:"blocking-settings.violations["+i.props.policy.policy["blocking-settings"].violations.indexOf(e)+"].alarm",checked:e.alarm||!1,onChange:function(e){return i.props.onChange(e)}})}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{type:"checkbox",id:"blocking-settings.violations["+i.props.policy.policy["blocking-settings"].violations.indexOf(e)+"].block",checked:e.block||!1,onChange:function(e){return i.props.onChange(e)}})}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{type:"checkbox",id:"blocking-settings.violations["+i.props.policy.policy["blocking-settings"].violations.indexOf(e)+"].learn",checked:e.learn||!1,onChange:function(e){return i.props.onChange(e)}})}),Object(O.jsx)("td",{children:Object(O.jsx)(C.a,{size:"sm",id:i.props.policy.policy["blocking-settings"].violations.indexOf(e),onClick:function(e){return i.props.onRemove(e)},children:"Remove"})})]},e.name)}))})]})})}}]),n}(l.a.Component),z=n(77),P=n(29),w=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).changeName=a.changeName.bind(Object(c.a)(a)),a.changeType=a.changeType.bind(Object(c.a)(a)),a.toggleMandatory=a.toggleMandatory.bind(Object(c.a)(a)),a.toggleCheckSignatures=a.toggleCheckSignatures.bind(Object(c.a)(a)),a.toggleHtmlNormalization=a.toggleHtmlNormalization.bind(Object(c.a)(a)),a.toggleBase64=a.toggleBase64.bind(Object(c.a)(a)),a.toggleAllowRepeatedOccurrences=a.toggleAllowRepeatedOccurrences.bind(Object(c.a)(a)),a.addHeader=a.addHeader.bind(Object(c.a)(a)),a.delHeader=a.delHeader.bind(Object(c.a)(a)),a.delAllHeaders=a.delAllHeaders.bind(Object(c.a)(a)),a}return Object(a.a)(n,[{key:"changeName",value:function(e){var t=this.props.policy;t.policy.headers.headers[e.target.id].name=e.target.value,this.props.onChange(t)}},{key:"changeType",value:function(e){var t=this.props.policy;t.policy.headers.headers[e.target.id].type=e.target.text,this.props.onChange(t)}},{key:"toggleMandatory",value:function(e){var t=this.props.policy;t.policy.headers.headers[e.target.id].mandatory=!t.policy.headers.headers[e.target.id].mandatory,this.props.onChange(t)}},{key:"toggleCheckSignatures",value:function(e){var t=this.props.policy;t.policy.headers.headers[e.target.id].checkSignatures=!t.policy.headers.headers[e.target.id].checkSignatures,this.props.onChange(t)}},{key:"toggleHtmlNormalization",value:function(e){var t=this.props.policy;t.policy.headers.headers[e.target.id].htmlNormalization=!t.policy.headers.headers[e.target.id].htmlNormalization,this.props.onChange(t)}},{key:"toggleBase64",value:function(e){var t=this.props.policy;t.policy.headers.headers[e.target.id].decodeValueAsBase64=!t.policy.headers.headers[e.target.id].decodeValueAsBase64,this.props.onChange(t)}},{key:"toggleAllowRepeatedOccurrences",value:function(e){var t=this.props.policy;t.policy.headers.headers[e.target.id].allowRepeatedOccurrences=!t.policy.headers.headers[e.target.id].allowRepeatedOccurrences,this.props.onChange(t)}},{key:"addHeader",value:function(e){var t=this.props.policy,n=new P.Header;t.policy.headers.add(n),this.props.onChange(t)}},{key:"delHeader",value:function(e){var t=this.props.policy;t.policy.headers.del(e.target.id),this.props.onChange(t)}},{key:"delAllHeaders",value:function(e){var t=this.props.policy;t.policy.headers.delAll(),this.props.onChange(t)}},{key:"render",value:function(){return Object(O.jsxs)("div",{children:[Object(O.jsx)("h2",{children:"Headers"}),Object(O.jsx)(T,{policy:this.props.policy,changeName:this.changeName,changeType:this.changeType,toggleMandatory:this.toggleMandatory,toggleCheckSignatures:this.toggleCheckSignatures,toggleHtmlNormalization:this.toggleHtmlNormalization,toggleAllowRepeatedOccurrences:this.toggleAllowRepeatedOccurrences,toggleBase64:this.toggleBase64,addHeader:this.addHeader,delHeader:this.delHeader,delAllHeaders:this.delAllHeaders})]})}}]),n}(l.a.Component),T=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){var e,t,n=this;return Object(O.jsxs)("div",{children:[Object(O.jsxs)(k.a,{striped:!0,bordered:!0,hover:!0,size:"sm",children:[Object(O.jsx)("thead",{children:Object(O.jsxs)("tr",{children:[Object(O.jsx)("th",{children:"Header Name"}),Object(O.jsx)("th",{children:"Type"}),Object(O.jsx)("th",{children:"Mandatory"}),Object(O.jsx)("th",{children:"Check Signatures"}),Object(O.jsx)("th",{children:"Normalize HTML"}),Object(O.jsx)("th",{children:"Decode Base64"}),Object(O.jsx)("th",{children:"Allow Repeated"}),Object(O.jsx)("th",{children:Object(O.jsx)(C.a,{size:"sm",onClick:this.props.delAllHeaders,children:"Remove"})})]})}),Object(O.jsx)("tbody",{children:null===(e=this.props.policy.policy)||void 0===e||null===(t=e.headers.headers)||void 0===t?void 0:t.map((function(e,t){return Object(O.jsxs)("tr",{className:"text-center",children:[Object(O.jsx)("td",{children:Object(O.jsx)(j.a,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onChange:function(e){return n.props.changeName(e)},size:"sm",value:e.name})}),Object(O.jsx)("td",{children:Object(O.jsxs)(S.a,{as:z.a,size:"sm",children:[Object(O.jsx)(S.a.Toggle,{children:e.type}),Object(O.jsxs)(S.a.Menu,{children:[Object(O.jsx)(S.a.Item,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onClick:function(e){return n.props.changeType(e)},children:"explicit"}),Object(O.jsx)(S.a.Item,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onClick:function(e){return n.props.changeType(e)},children:"wildcard"})]})]})}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onChange:function(e){return n.props.toggleMandatory(e)},checked:e.mandatory})}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onChange:function(e){return n.props.toggleCheckSignatures(e)},checked:e.checkSignatures})}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onChange:function(e){return n.props.toggleHtmlNormalization(e)},checked:e.htmlNormalization})}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onChange:function(e){return n.props.toggleBase64(e)},checked:e.decodeValueAsBase64})}),Object(O.jsx)("td",{children:Object(O.jsx)(N.a.Check,{id:n.props.policy.policy.headers.headers.indexOf(e).toString(),onChange:function(e){return n.props.toggleAllowRepeatedOccurrences(e)},checked:e.allowRepeatedOccurrences})}),Object(O.jsx)("td",{children:Object(O.jsx)(C.a,{size:"sm",onClick:function(e){return n.props.delHeader(e)},children:"Remove"})})]},t)}))})]}),Object(O.jsx)(C.a,{size:"sm",onClick:function(e){return n.props.addHeader(e)},children:"Add Header"})]})}}]),n}(l.a.Component),M=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(a.a)(n,[{key:"render",value:function(){return Object(O.jsxs)("div",{children:["General"===this.props.visibleComponent&&Object(O.jsx)(f,{policy:this.props.policy,onChange:this.props.onChange}),"Blocking Settings"===this.props.visibleComponent&&Object(O.jsx)(A,{policy:this.props.policy,onChange:this.props.onChange}),"Headers"===this.props.visibleComponent&&Object(O.jsx)(w,{policy:this.props.policy,onChange:this.props.onChange})]})}}]),n}(l.a.Component),B={policy:{name:"policy_name",template:{name:"POLICY_TEMPLATE_NGINX_BASE"},applicationLanguage:"utf-8",enforcementMode:"blocking"}},R=function(e){Object(o.a)(n,e);var t=Object(r.a)(n);function n(e){var a;return Object(i.a)(this,n),(a=t.call(this,e)).state={policy:new P.Policy(B),textArea:JSON.stringify(new P.Policy(B).toPolicy(),void 0,4),visibleComponent:"General",isValid:new P.Policy(B).isValid()},a.handleChange=a.handleChange.bind(Object(c.a)(a)),a.handleMenuClick=a.handleMenuClick.bind(Object(c.a)(a)),a}return Object(a.a)(n,[{key:"handleChange",value:function(e){this.setState((function(t){return{isValid:Object(P.isValidPolicy)(e.toPolicy()),policy:e,textArea:JSON.stringify(e.toPolicy(),void 0,4)}}))}},{key:"handleTextChange",value:function(e){this.setState({textArea:e.target.value}),function(e){if("string"!==typeof e)return!1;try{return JSON.parse(e),!0}catch(t){return!1}}(e.target.value)&&Object(P.isValidPolicy)(JSON.parse(e.target.value))?this.setState({isValid:!0,policy:new P.Policy(JSON.parse(e.target.value))}):this.setState({isValid:!1})}},{key:"handleMenuClick",value:function(e){this.setState((function(){return{visibleComponent:e}}))}},{key:"render",value:function(){var e=this;return Object(O.jsx)("div",{className:"app",children:Object(O.jsxs)(p.a,{children:[Object(O.jsx)(g.a,{children:Object(O.jsx)(u.a,{children:Object(O.jsx)("h1",{children:"NGINX App Protect Policy Editor"})})}),Object(O.jsxs)(g.a,{children:[Object(O.jsx)(u.a,{md:"auto",children:Object(O.jsx)(y,{onClick:this.handleMenuClick,activeKey:this.state.visibleComponent})}),Object(O.jsx)(u.a,{children:Object(O.jsx)(M,{policy:this.state.policy,onChange:this.handleChange,visibleComponent:this.state.visibleComponent})})]}),Object(O.jsx)(g.a,{children:Object(O.jsx)(u.a,{children:Object(O.jsx)(j.a,{as:"textarea",value:this.state.textArea,rows:20,cols:60,onChange:function(t){return e.handleTextChange(t)},style:{color:this.state.isValid?"green":"red"}})})})]})})}}]),n}(l.a.Component);h.a.render(Object(O.jsx)(R,{}),document.getElementById("root"))}},[[149,1,2]]]);
//# sourceMappingURL=main.bc955cb9.chunk.js.map